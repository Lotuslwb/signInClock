<!DOCTYPE html>
<!--[if IEMobile 7 ]>
<html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="description" content="">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="cleartype" content="on">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <script src="js/dpi.js"></script>
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="swiper/swiper-3.3.1.min.css">

</head>
<body>
    <!--需要预加载的images-->
    <div class="f-hide" id="f-hide">
        <img src="./v1_files/bg.png">
        <img src="./v1_files/loading-img-1.png">
        <img src="./v1_files/loading-img-2.png">
        <img src="./v1_files/startpage-bg.png">

        <img src="./v1_files/1.mp3">
        <img src="./v1_files/2.mp3">
        <img src="./v1_files/3.mp3">
    </div>


    <div class="page loading-page active" style="display: none;">
        <div class="loading-img dog"></div>
        <div class="loading-dots">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>
    </div>

    <div class="page swiper-page active">
        <div class="swiper-container swiper-container-horizontal">
            <div class="swiper-wrapper">
                <div class="swiper-slide start-page swiper-no-swiping swiper-slide-active" style="width: 640px;">
                    <img src="./v1_files/startpage-music.png" class="startpage-music">
                    <img src="./v1_files/startpage-icon1.png" class="startpage-icon1">
                    <img src="./v1_files/startpage-icon2.png" class="startpage-icon2">
                    <div class="btn withDog J-slideNext active">开始测试</div>
                </div>
                <div class="swiper-slide gender-page swiper-no-swiping swiper-slide-next" style="width: 640px;">
                    <img src="./v1_files/genderpage-pic1.png" class="pic">
                    <div class="Q-list">
                        <div class="Q-item">
                            <span class="radio"></span>
                            <span class="label">男</span>
                        </div>
                        <div class="Q-item">
                            <span class="radio"></span>
                            <span class="label">女</span>
                        </div>
                    </div>
                    <div class="btn J-slideNext">确定</div>
                </div>
                <!-- Q1 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">如果有一个可以马上出国的机会，你会希望会是多长？</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="2" data-tag="1-1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">再给我一个暑假的时间</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="1" data-tag="1-2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">1个月就够了，我爱学习/工作</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="3" data-tag="1-3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">我想要无拘无束的间隔年</span>
                            </div>
                        </div>

                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-1.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q2 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">如果要选一本书做旅游攻略，你会选择？</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">《孤独星球》、《米其林指南》等各种砖头旅游书</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">《搭车去柏林》、《背包十年》等旅行故事书</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">现在谁还看书，穷游或者马蜂窝上拷贝一份攻略直接出发啦</span>
                            </div>
                        </div>

                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-2.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q3 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">如果要去的这个地方语言不通，你会选择</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="3" data-tag="3-1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">临时抱佛脚学几句当地语言</span>
                            </div>
                        </div>

                        <div class="Q-item" data-value="2" data-tag="3-2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">手机里装好各种翻译APP</span>
                            </div>
                        </div>

                        <div class="Q-item" data-value="1" data-tag="3-3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">Body Language解决一切问题</span>
                            </div>
                        </div>

                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-3.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q4 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">哪种音乐更能唤起你的好心情?请点击播放</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="1" data-tag="4-1">
                            <div class="Q-itemWrap">
                                <span class="radio music-radio"></span>
                                <span class="music" data-src="/tourTest/mp3/1.mp3">
                                    <span class="pross J-music" style="width:230px;"><img src="./v1_files/music-pross-icon.png" class="pross-icon">
                                    </span>
                                    <span class="readIcon"></span>
                                    <span class="timer">10</span>
                                </span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="3" data-tag="4-2">
                            <div class="Q-itemWrap">
                                <span class="radio music-radio"></span>
                                <span class="music" data-src="/tourTest/mp3/2.mp3">
                                    <span class="pross J-music" style="width:295px;"><img src="./v1_files/music-pross-icon.png" class="pross-icon">
                                    </span>
                                    <span class="readIcon"></span>
                                    <span class="timer">13</span>
                                </span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="2" data-tag="4-3">
                            <div class="Q-itemWrap">
                                <span class="radio music-radio"></span>
                                <span class="music" data-src="/tourTest/mp3/3.mp3">
                                    <span class="pross J-music" style="width:260px;"><img src="./v1_files/music-pross-icon.png" class="pross-icon">
                                    </span>
                                    <span class="readIcon"></span>
                                    <span class="timer">12</span>
                                </span>
                            </div>
                        </div>

                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-4.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q5 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">每天早上起床，你是什么状态？</div>
                    <div class="Q-list">
                        <div class="Q-item mb45" data-value="2" data-tag="5-1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">7：05，7：15，7：25，7：35……设了那么多闹钟，还是起不来</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="3" data-tag="5-2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">闹钟一响我就能起床</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="1" data-tag="5-3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">每天都要睡到自然醒才起床</span>
                            </div>
                        </div>
                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-5.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q6 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">推开门，你希望看到什么景象？</div>
                    <div class="Q-list">
                        <div class="Q-item imageItem" data-value="3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">落日余晖 <img class="image" src="./v1_files/Q6-option-1.png"></span>
                            </div>
                        </div>
                        <div class="Q-item imageItem" data-value="2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">碧空万里 <img class="image" src="./v1_files/Q6-option-2.png"></span>
                            </div>
                        </div>
                        <div class="Q-item imageItem" data-value="1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">繁星满天 <img class="image" src="./v1_files/Q6-option-3.png">
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="h45"></div>
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q7 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">哪句诗句最能唤起你的向往？</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">大漠孤烟直，长河落日圆</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">海边日影静犹长，烟里渔船接杳茫</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">坐看云卷云舒，静听花开花落</span>
                            </div>
                        </div>
                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-7.png" alt="">
                    <div class="h45"></div>
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q8 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">怎么样的行程安排会让你觉得放松和舒适？</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="2" data-tag="8-1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">拿着相机走遍大街小巷，寻找不曾被人发现的角落</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="1" data-tag="8-2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">找一个地方躺着放空就最舒适了</span>
                            </div>
                        </div>
                        <div class="Q-item" data-value="3" data-tag="8-3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">漂流、潜水、跳伞，越刺激越好</span>
                            </div>
                        </div>
                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-8.png" alt="">
                    <div class="btn J-slideNext">下一题</div>
                </div>

                <!-- Q9 -->
                <div class="swiper-slide Question-page swiper-no-swiping" style="width: 640px;">
                    <div class="Q-title">假期即将结束，你的心情更符合？</div>
                    <div class="Q-list">
                        <div class="Q-item" data-value="1">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">好累，想赶紧回家</span>
                            </div>
                        </div>

                        <div class="Q-item" data-value="2">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">还没玩够！希望下次假期赶紧到来！</span>
                            </div>
                        </div>

                        <div class="Q-item" data-value="3">
                            <div class="Q-itemWrap">
                                <span class="radio"></span>
                                <span class="label">电量满格，回去好好做人</span>
                            </div>
                        </div>
                    </div>
                    <img class="Q-pic" src="./v1_files/Q-pic-9.png" alt="">
                    <div class="h45"></div>

                    <div class="btn J-finishQ">下一题</div>
                </div>

                <!-- leads -->
                <div class="swiper-slide leads-page swiper-no-swiping" style="width: 640px;">
                    <img class="leads-title" src="./v1_files/leads-title.png">
                    <div class="form">
                        <input type="text" class="input nickname J-name leads-Q" placeholder="请输入您的昵称">
                        <input type="tel" class="input tel J-tel leads-Q" name="telPhone" placeholder="请输入您的手机号">
                        <div class="selectWrap inputWrap">
                            <input type="text" class="input qcode-input leads-Q" placeholder="请输入验证码">
                            <div class="qcode-btn J-sendSMS">获取验证码</div>
                        </div>
                        <div class="selectWrap">
                            <select class="city-select J-city select leads-Q">
                                <option value="">请选择您的省份</option>
                                
                                <option data-id="110000" value="11">
                                    北京
                                </option>
                                
                                <option data-id="120000" value="12">
                                    天津
                                </option>
                                
                                <option data-id="310000" value="31">
                                    上海
                                </option>
                                
                                <option data-id="500000" value="50">
                                    重庆
                                </option>
                                
                                <option data-id="130000" value="13">
                                    河北
                                </option>
                                
                                <option data-id="410000" value="41">
                                    河南
                                </option>
                                
                                <option data-id="530000" value="53">
                                    云南
                                </option>
                                
                                <option data-id="210000" value="21">
                                    辽宁
                                </option>
                                
                                <option data-id="230000" value="23">
                                    黑龙江
                                </option>
                                
                                <option data-id="430000" value="43">
                                    湖南
                                </option>
                                
                                <option data-id="340000" value="34">
                                    安徽
                                </option>
                                
                                <option data-id="370000" value="37">
                                    山东
                                </option>
                                
                                <option data-id="650000" value="65">
                                    新疆
                                </option>
                                
                                <option data-id="320000" value="32">
                                    江苏
                                </option>
                                
                                <option data-id="330000" value="33">
                                    浙江
                                </option>
                                
                                <option data-id="360000" value="36">
                                    江西
                                </option>
                                
                                <option data-id="420000" value="42">
                                    湖北
                                </option>
                                
                                <option data-id="450000" value="45">
                                    广西
                                </option>
                                
                                <option data-id="620000" value="62">
                                    甘肃
                                </option>
                                
                                <option data-id="140000" value="14">
                                    山西
                                </option>
                                
                                <option data-id="150000" value="15">
                                    内蒙古
                                </option>
                                
                                <option data-id="610000" value="61">
                                    陕西
                                </option>
                                
                                <option data-id="220000" value="22">
                                    吉林
                                </option>
                                
                                <option data-id="350000" value="35">
                                    福建
                                </option>
                                
                                <option data-id="520000" value="52">
                                    贵州
                                </option>
                                
                                <option data-id="440000" value="44">
                                    广东
                                </option>
                                
                                <option data-id="630000" value="63">
                                    青海
                                </option>
                                
                                <option data-id="540000" value="54">
                                    西藏
                                </option>
                                
                                <option data-id="510000" value="51">
                                    四川
                                </option>
                                
                                <option data-id="640000" value="64">
                                    宁夏
                                </option>
                                
                                <option data-id="460000" value="46">
                                    海南
                                </option>
                                
                            </select>
                        </div>
                        <div class="selectWrap">
                            <select class="city-select J-city-child select leads-Q">
                                <option value="">请选择您的城市</option>
                            </select>
                        </div>
                        <div class="selectWrap">
                            <select class="year-select select leads-Q">
                                <option value="">出生年</option>
                                
                                <option value="1960">
                                    1960
                                </option>
                                
                                <option value="1961">
                                    1961
                                </option>
                                
                                <option value="1962">
                                    1962
                                </option>
                                
                                <option value="1963">
                                    1963
                                </option>
                                
                                <option value="1964">
                                    1964
                                </option>
                                
                                <option value="1965">
                                    1965
                                </option>
                                
                                <option value="1966">
                                    1966
                                </option>
                                
                                <option value="1967">
                                    1967
                                </option>
                                
                                <option value="1968">
                                    1968
                                </option>
                                
                                <option value="1969">
                                    1969
                                </option>
                                
                                <option value="1970">
                                    1970
                                </option>
                                
                                <option value="1971">
                                    1971
                                </option>
                                
                                <option value="1972">
                                    1972
                                </option>
                                
                                <option value="1973">
                                    1973
                                </option>
                                
                                <option value="1974">
                                    1974
                                </option>
                                
                                <option value="1975">
                                    1975
                                </option>
                                
                                <option value="1976">
                                    1976
                                </option>
                                
                                <option value="1977">
                                    1977
                                </option>
                                
                                <option value="1978">
                                    1978
                                </option>
                                
                                <option value="1979">
                                    1979
                                </option>
                                
                                <option value="1980">
                                    1980
                                </option>
                                
                                <option value="1981">
                                    1981
                                </option>
                                
                                <option value="1982">
                                    1982
                                </option>
                                
                                <option value="1983">
                                    1983
                                </option>
                                
                                <option value="1984">
                                    1984
                                </option>
                                
                                <option value="1985">
                                    1985
                                </option>
                                
                                <option value="1986">
                                    1986
                                </option>
                                
                                <option value="1987">
                                    1987
                                </option>
                                
                                <option value="1988">
                                    1988
                                </option>
                                
                                <option value="1989">
                                    1989
                                </option>
                                
                                <option value="1990">
                                    1990
                                </option>
                                
                                <option value="1991">
                                    1991
                                </option>
                                
                                <option value="1992">
                                    1992
                                </option>
                                
                                <option value="1993">
                                    1993
                                </option>
                                
                                <option value="1994">
                                    1994
                                </option>
                                
                                <option value="1995">
                                    1995
                                </option>
                                
                                <option value="1996">
                                    1996
                                </option>
                                
                                <option value="1997">
                                    1997
                                </option>
                                
                                <option value="1998">
                                    1998
                                </option>
                                
                                <option value="1999">
                                    1999
                                </option>
                                
                                <option value="2000">
                                    2000
                                </option>
                                
                                <option value="2001">
                                    2001
                                </option>
                                
                                <option value="2002">
                                    2002
                                </option>
                                
                                <option value="2003">
                                    2003
                                </option>
                                
                                <option value="2004">
                                    2004
                                </option>
                                
                                <option value="2005">
                                    2005
                                </option>
                                
                                <option value="2006">
                                    2006
                                </option>
                                
                                <option value="2007">
                                    2007
                                </option>
                                
                                <option value="2008">
                                    2008
                                </option>
                                
                                <option value="2009">
                                    2009
                                </option>
                                
                                <option value="2010">
                                    2010
                                </option>
                                
                                <option value="2011">
                                    2011
                                </option>
                                
                                <option value="2012">
                                    2012
                                </option>
                                
                                <option value="2013">
                                    2013
                                </option>
                                
                                <option value="2014">
                                    2014
                                </option>
                                
                                <option value="2015">
                                    2015
                                </option>
                                
                                <option value="2016">
                                    2016
                                </option>
                                
                                <option value="2017">
                                    2017
                                </option>
                                
                                <option value="2018">
                                    2018
                                </option>
                                
                            </select>
                            <select class="month-select select leads-Q">
                                <option value="">月</option>
                                
                                <option value="1">
                                    1
                                </option>
                                
                                <option value="2">
                                    2
                                </option>
                                
                                <option value="3">
                                    3
                                </option>
                                
                                <option value="4">
                                    4
                                </option>
                                
                                <option value="5">
                                    5
                                </option>
                                
                                <option value="6">
                                    6
                                </option>
                                
                                <option value="7">
                                    7
                                </option>
                                
                                <option value="8">
                                    8
                                </option>
                                
                                <option value="9">
                                    9
                                </option>
                                
                                <option value="10">
                                    10
                                </option>
                                
                                <option value="11">
                                    11
                                </option>
                                
                                <option value="12">
                                    12
                                </option>
                                
                            </select>
                            <select class="date-select select leads-Q">
                                <option value="">日</option>
                                
                                <option value="1">
                                    1
                                </option>
                                
                                <option value="2">
                                    2
                                </option>
                                
                                <option value="3">
                                    3
                                </option>
                                
                                <option value="4">
                                    4
                                </option>
                                
                                <option value="5">
                                    5
                                </option>
                                
                                <option value="6">
                                    6
                                </option>
                                
                                <option value="7">
                                    7
                                </option>
                                
                                <option value="8">
                                    8
                                </option>
                                
                                <option value="9">
                                    9
                                </option>
                                
                                <option value="10">
                                    10
                                </option>
                                
                                <option value="11">
                                    11
                                </option>
                                
                                <option value="12">
                                    12
                                </option>
                                
                                <option value="13">
                                    13
                                </option>
                                
                                <option value="14">
                                    14
                                </option>
                                
                                <option value="15">
                                    15
                                </option>
                                
                                <option value="16">
                                    16
                                </option>
                                
                                <option value="17">
                                    17
                                </option>
                                
                                <option value="18">
                                    18
                                </option>
                                
                                <option value="19">
                                    19
                                </option>
                                
                                <option value="20">
                                    20
                                </option>
                                
                                <option value="21">
                                    21
                                </option>
                                
                                <option value="22">
                                    22
                                </option>
                                
                                <option value="23">
                                    23
                                </option>
                                
                                <option value="24">
                                    24
                                </option>
                                
                                <option value="25">
                                    25
                                </option>
                                
                                <option value="26">
                                    26
                                </option>
                                
                                <option value="27">
                                    27
                                </option>
                                
                                <option value="28">
                                    28
                                </option>
                                
                                <option value="29">
                                    29
                                </option>
                                
                                <option value="30">
                                    30
                                </option>
                                
                                <option value="31">
                                    31
                                </option>
                                
                            </select>
                        </div>
                        <div class="rightChecked"> <span class="checkbox active"></span> 我已阅读并同意 <span class="href">英孚隐私政策

 <div>
        var tagData = [{
            tagId: '1-1',
            text: '浪漫主义派',
            des:'倾向1-2月的休息',
        }, {
            tagId: '1-2',
            text: '理性主义派',
            des:'倾向几周的休息',
        }, {
            tagId: '1-3',
            text: '白日梦想派',
            des:'倾向于间隔年',
        }, {
            tagId: '3-1',
            text: '语言爱好者',
            des:'对语言学习有兴趣',
        }, {
            tagId: '3-2',
            text: '周密计划员',
            des:'擅长运用翻译APP'
        }, {
            tagId: '3-3',
            text: '佛系走天下',
            des:'旅行时胆子大不爱做计划',
        }, {
            tagId: '4-1',
            text: '热情似火'
        }, {
            tagId: '4-2',
            text: '深沉如你'
        }, {
            tagId: '4-3',
            text: '自由活泼'
        }, {
            tagId: '5-1',
            text: '拖延症患者'
        }, {
            tagId: '5-2',
            text: '极度自律'
        }, {
            tagId: '5-3',
            text: '随心所欲'
        }, , {
            tagId: '8-1',
            text: '另辟蹊径'
        }, {
            tagId: '8-2',
            text: '度假=放空'
        }, {
            tagId: '8-3',
            text: '极限挑战'
        }, ];
        var levelMap = ['', '旅行属性：休闲懒散派，适合海滨城市如布莱顿、马耳他、迈阿密等',
            '旅行属性：逛吃逛吃党，适合饮食丰富，特色小店、手工艺店比较多的城市，如巴黎、巴塞罗那、新加坡、首尔、马德里等',
            '旅行属性：城市暴走族，适合去面积不大，但到处都有景点、风景和历史建筑的城市，比如罗马、东京、曼城、柏林', '你的旅行属性为：打卡狂魔，适合大山大河、需要自驾的地方，如美西、加拿大、新西兰等'
        ];

        function genOptions(data) {
            var returnStr = '';
            data.map(item => {
                returnStr += '<option value="' + item.value + '">' + item.text + '</option>';
            });
            return returnStr;
        }
    </div>

  <div>
        var mySwiper;
        var timer;

        function indexHanlder() {
            this.init();
        }

        indexHanlder.prototype = {
            init: function () {
                this.countdown = 60;
                this.timer = null;

                this.initMain();
                this.initMusic();
                this.bindEvnet(this);

                // var me=this;
                // var tagList=["1-3", "3-3", "4-2", "5-3", "8-3"];
                // var img=new Image();
                // img.src='/tourTest/img/v1/female_2_1.jpg';
                // img.onload=()=>{
                //     me.genTagImg(tagList,img,'female_2_1.jpg');
                // }  
                // $('#myCanvas').show();
            },
            initMain: function () {
                var h = $('body').height();
                var Qh = $('.Q-header').height();
                $('.Q-main').height(h - Qh);
            },
            initMusic: function () {
                var audioElement = this.audioElement = document.createElement('audio');
                audioElement.controls = true;
                audioElement.loop = false;
                audioElement.autoplay = 'autoplay';
                audioElement.onended = function () {
                    $('.music').removeClass('play');
                };
            },
            playMusic: function ($music) {
                var audioElement = this.audioElement;
                var src = $music.data('src');
                audioElement.setAttribute('src', src);
                audioElement.load();
                audioElement.play();
                $('.music').removeClass('play');
                $music.addClass('play').addClass('done');
            },
            stopMusic: function () {
                var audioElement = this.audioElement;
                audioElement.pause();
                $('.music').removeClass('play');
            },
            bindEvnet: function () {
                var me = this;
                var self = this;

                $('.rightChecked').click(function () {
                    var $checkbox = $(this).find('.checkbox');
                    $checkbox.hasClass('active') ? $checkbox.removeClass('active') : $checkbox.addClass(
                        'active');
                })
                $('.href').click(function (e) {
                    e.stopPropagation();
                    $('.right-pop').show();
                })
                $('.closed').click(function () {
                    $('.right-pop').hide();
                })

                $('.month-select').change(function () {
                    var month = $(this).val();
                    var days = 31;
                    if (month == '2') {
                        days = 28;
                    } else if (month == '4' || month == "6" || month == "9" || month == "11") {
                        days = 30
                    }
                    me.genDates(days);
                })

                $('.J-music').click(function (e) {
                    // e.stopPropagation();
                    var $music = $(this).parents('.music');

                    if ($music.hasClass('play')) {
                        me.stopMusic();
                    } else {
                        me.playMusic($music);
                    }
                })
                $('.J-page1-btn').click(function () {
                    timer && clearInterval(timer);
                    mySwiper.slideNext();
                })
                $('.J-slideNext').click(function () {
                    if ($(this).hasClass('active')) {
                        mySwiper.slideNext();
                        me.stopMusic();
                    }
                })
                $('.J-finishQ').click(function () {
                    if ($(this).hasClass('active')) {
                        mySwiper.slideNext();
                        me.getResult();
                    }
                })

                $('.Q-item').click(function () {
                    if ($(this).parents('.leads-page').length) return true;

                    $(this).addClass('active').siblings('.Q-item').removeClass('active');
                    $(this).parents('.swiper-slide').find('.btn').addClass('active');
                })

                $(".leads-page .leads-Q").on("change", function () {
                    console.log(checkVal());
                    if (checkVal()) {
                        $(this).parents('.swiper-slide').find('.btn').addClass('active');
                    } else {
                        $(this).parents('.swiper-slide').find('.btn').removeClass('active');
                    }
                });

                // 获取验证码
                $('.J-sendSMS').click(function () {
                    var $self = $(this);
                    if ($self.parent().hasClass('disabled')) {
                        return false;
                    }
                    var tel = $('input[name=telPhone]').val();
                    if (!tel) {
                        toast('请输入手机号');
                        return false;
                    }
                    if (!/^1[3|4|5|7|8|9][0-9]{9}$/.test(tel)) {
                        toast('请输入正确的手机号');
                        return false;
                    }
                    startTimer();

                    $.ajax({
                        type: 'POST',
                        url: '/tourTest/api/sendSMS',
                        data: {
                            tel: tel,
                        },
                        success: function (data) {
                            if (data.status == 200) {
                                toast('短信发送成功');
                            } else {
                                toast(data.data);
                            }
                        },
                        dataType: 'json'
                    });
                });

                function startTimer() {
                    var $self = $('.J-sendSMS');
                    var countdown = self.countdown;

                    $self.text('已发送(' + countdown + 's)')
                    $self.parent().addClass('disabled');

                    self.timer = setInterval(function () {
                        countdown -= 1;
                        $self.text('已发送(' + countdown + 's)')
                        $self.parent().addClass('disabled');
                        if (countdown <= 0) {
                            stopTimer();
                        }
                    }, 1000);
                }

                function stopTimer() {
                    var $self = $('.J-sendSMS');
                    clearInterval(self.timer);
                    $self.text('获取验证码')
                    $self.parent().removeClass('disabled');
                }

                function checkVal() {
                    var result = true;
                    $('.leads-page .leads-Q').each(function () {
                        if (!$(this).val()) result = false;
                    })
                    return result;
                }

                $('.J-city').change(function () {
                    var id = $(this).find("option:selected").data('id');
                    $.ajax({
                        url: '/tourTest/queryCity',
                        dataType: 'json',
                        crossDomain: true,
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            id: id
                        }),
                        success: function (res) {
                            console.log(res);
                            var data = res.data[0].map(item => {
                                return {
                                    value: item.id,
                                    text: item.name
                                }
                            });
                            var str = genOptions(data);
                            $(".J-city-child").html(str);
                        }
                    });
                })

                $('.J-submit').click(function () {
                    if (!$(this).hasClass('active') || !checkVal()) {
                        return false;
                    }

                    if (!me.checkTel($('.J-tel').val())) {
                        toast('手机号格式有误');
                        return false;
                    }

                    if (!$('.rightChecked .checkbox').hasClass('active')) {
                        toast('请勾选隐私策略');
                        return false;
                    }




                    //The main object to be sent with the submission request
                    var submissionData = new Object();
                    //Individual properties of the main object
                    var customer = new Object();
                    var extendedDetail = new Object();
                    var weChatData = new Object();
                    var trackingData = new Object();
                    var campaigndata = new Object();

                    var year = $('.year-select').val();
                    var month = $('.month-select').val();
                    var date = $('.date-select').val();
                    var qcode = $('.qcode-input').val();

                    customer.FirstName = $('.J-name').val().substr(1, $('.J-name').val().length - 1);
                    customer.LastName = $('.J-name').val().substr(0, 1);
                    customer.MobilePhone = $('.J-tel').val();
                    customer.DateOfBirth = new Date(year + '-' + month + '-' + date); // January 9th, 1975 (0-based index for months)
                    customer.StateRegionName = $('.J-city').find("option:selected").text();
                    customer.StateRegionCode = "CN-" + $('.J-city').find("option:selected").val();
                    customer.CountryOfResidence = "CN";
                    customer.Gender = $('.gender-page').find('.Q-item.active').index() == 0 ? "M" : "F";
                    customer.Comments ='用户标签属性：'+ me.tagDes + ';'+ levelMap[me.level];
                    customer.City = $('.J-city-child').find("option:selected").text();
                    customer.Email = customer.MobilePhone + "@noemail.com";


                    // Tracking
                    trackingData.Etag = channel + "_Travel_IDV1";
                    trackingData.EntrySourceCode = SourceCode;

                    //Campaign Data
                    campaigndata.CampaignName = "Travel_ID";
                    campaigndata.CampaignAllocationPrograms = "ILS,LY";
                    campaigndata.CampaignAllocationCode = "mixed";

                    //Extended Details
                    extendedDetail.WantsMoreInfo = true;
                    extendedDetail.WantsBrochure = true;



                    //Assigning individual classes to the main object
                    submissionData.customer = customer;
                    submissionData.extendedDetail = extendedDetail;
                    submissionData.tracking = trackingData;
                    submissionData.weChat = weChatData;
                    submissionData.campaignData = campaigndata;
                    submissionData.qcode = $('.qcode-input').val();


                    console.log(submissionData);

                    /** debug */ 
                    $('.loading-page').fadeIn();
                    setTimeout(function () {
                        $('.loading-page').fadeOut();
                    }, 3000)
                    mySwiper.slideNext();
                    return false;


                    $.ajax({
                        url: '/tourTest/form',
                        dataType: 'json',
                        crossDomain: true,
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify(submissionData),
                        success: function (res) {
                            console.log(res);
                            if (res.status == 999) {
                                toast(res.data)
                            } else {
                                $('.loading-page').fadeIn();
                                setTimeout(function () {
                                    $('.loading-page').fadeOut();
                                }, 3000)
                                mySwiper.slideNext();
                            }
                        }
                    });
                });
            },
            getResult: function () {
                var me = this;
                var sex = $('.gender-page').find('.Q-item.active').index(); // 0 为男， 1为女
                var totalScore = 0;
                var tagList = [];
                $('.Question-page .Q-list').each(function () {
                    var $Qitem = $(this).find('.Q-item.active');
                    var tag = $Qitem.data('tag');
                    totalScore += $Qitem.data('value') * 1;
                    tag && tagList.push(tag);
                });
                var level = this.getScoreLevel(totalScore);
                var filterStr = (sex == 0 ? "male" : "female") + "_" + level;
                console.log(filterStr);
                var result = resultList.filter(function (item) {
                    return item.indexOf(filterStr) == 0;
                }).random();
                console.log(result);
                this.level = level;
                var resultURL = '/tourTest/img/v1/' + result;
                var img = new Image();
                img.src = resultURL;
                img.onload = function () {
                    var tagImg = me.genTagImg(tagList, img, result);
                     
                    me.tagDes=me.genTagDes(tagList, img, result);

                    $('.result-pic').attr('src', tagImg).parents('.result-page').css('background',
                        'url(/tourTest/img/v1/bg/' + result + ')');
                    $('.result-txt').addClass(result.split('.')[0]);
                }
            },
            genTagDes:function(tagList){
                var tagDesList = tagList.map(item => {
                    var tagObj = tagData.find(it => it && it.tagId == item);
                    return tagObj.des;
                })
                return tagDesList.filter(it=>it).join();
            },
            genTagImg: function (tagList, img, result) {
                var tagImg;
                var tagTxtList = tagList.map(item => {
                    var tagObj = tagData.find(it => it && it.tagId == item)
                    return tagObj.text;
                })
                var myCanvas = $('#myCanvas')[0];
                var ctx = myCanvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                tagTxtList.map((text, index) => {
                    var styleObj = tplTagStyle[result][index];
                    drawTag(text, styleObj);
                })

                tagImg = myCanvas.toDataURL("image/png");
                return tagImg;

                function drawTag(text, styleObj) {
                    console.log(styleObj);
                    var tagW = 170,
                        tagH = 50,
                        x = styleObj.x,
                        y = styleObj.y;
                    ctx.beginPath();
                    ctx.rect(x, y, tagW, tagH);
                    ctx.fillStyle = '#FFFFFF';
                    ctx.fill();
                    ctx.lineWidth = "4";
                    ctx.strokeStyle = styleObj.borderColor;
                    ctx.rect(x, y, tagW, tagH);
                    ctx.stroke();
                    ctx.textAlign = "center";
                    ctx.fillStyle = '#4d4d4d';
                    ctx.font = "28px MHEIPRCHEAVY";
                    ctx.fillText(text, x + tagW / 2, y + 36, tagW);
                }
            },
            getScoreLevel: function (score) {
                var level = 0;
                if (score.range(9, 13)) {
                    level = 1;
                } else if (score.range(14, 19)) {
                    level = 2;
                } else if (score.range(20, 24)) {
                    level = 3;
                } else if (score.range(25, 27)) {
                    level = 4;
                }
                return level;
            },
            checkTel: function (tel) {
                var reg = /^0?1[3|4|5|6|7|8|9][0-9]\d{8}$/;
                return reg.test(tel);
            },
            genDates: function (days) {
                var html = "<option value=''>日</option>";
                for (var i = 1; i <= days; i++) {
                    html += '<option value="' + i + '">' + i + '</option>';
                }
                $('.date-select').html(html);
            }
        }
        var page = new indexHanlder();
    </div>

    
                        </span></div>
                    </div>

                    <!-- <img class="leads-pic" src="/tourTest/img/Q-pic-leads.png" alt=""> -->
                    <div class="btn J-submit">确认</div>
                </div>
                <div class="swiper-slide result-page result-v1 swiper-no-swiping" style="width: 640px;">
                    <img src="http://localhost:8090/tourTest/v1" class="result-pic">
                    <img src="./v1_files/result-text.png" class="result-txt">
                </div>
            </div>
        </div>
    </div>
    <canvas id="myCanvas" width="640" height="1268"></canvas>
    <div class="right-pop">
        <div class="overlay"></div>
        <div class="pop-content">
            <iframe class="iframe" src="./v1_files/saved_resource.html" frameborder="0"></iframe>
        </div>
        <img class="closed" src="./v1_files/pop-closed.png">
    </div>
    <script src="./v1_files/jquery.js"></script>
    <script src="./v1_files/imagesloaded.pkgd.min.js"></script>
    <script src="./v1_files/swiper-3.3.1.jquery.min.js"></script>
    <script src="./v1_files/tplTagStyle.js"></script>
    <script>
        var resultList = "female_1_1.jpg,female_1_2.jpg,female_2_1.jpg,female_2_2.jpg,female_3_1.jpg,female_4_1.jpg,male_1_1.jpg,male_2_1.jpg,male_3_1.jpg,male_4_1.jpg".split(',');
        var channel = "";
        var SourceCode = "";

        Number.prototype.range = function (min, max) {
            return this >= min && this <= max;
        }

        Array.prototype.random = function () {
            var index = Math.floor(Math.random() * this.length)
            return this[index];
        }

        if (typeof Array.prototype.filter != "function") {
            Array.prototype.filter = function (fn, context) {
                var arr = [];
                if (typeof fn === "function") {
                    for (var k = 0, length = this.length; k < length; k++) {
                        fn.call(context, this[k], k, this) && arr.push(this[k]);
                    }
                }
                return arr;
            };
        }

        function initMySwiper() {
            var mySwiper = new Swiper('.swiper-container', {
                noSwiping: true
            })

            return mySwiper;
        }
    </script>
  
    <script>
        var loaded = false;
        var loaded_ani = false;


        //预加载器
        function loader() {
            this.init();
        }

        loader.prototype = {
            init: function () {
                var me = this;
                var loaded = 0;

                if ($('body').length === 0 || navigator.userAgent.indexOf('MSIE 9') != -1) {
                    me.onLoaded();
                } else {
                    var imgLoad = imagesLoaded('body');
                    imgLoad.on('progress', function (instance, image) {
                        loaded++;
                        if (loaded == instance.images.length) {
                            me.onLoaded();
                        }
                    });
                }
            },
            onLoaded: function () {

            }
        }

        var loader = new loader();
        loader.onLoaded = function () {
            loaded = true;
            $('.loading-page').fadeOut();
            $('.swiper-page').addClass('active');
            var $btn = $('.J-page1-btn');
            timer = setInterval(function () {
                $btn.hasClass('active') ? $btn.removeClass('active') : $btn.addClass('active');
            }, 1500)
            mySwiper = initMySwiper();
        }
    </script>

    <div class="toast"></div>
    <script>
        var toast = function (msg, timer) {
            $('.toast').text(msg).fadeIn();
            setTimeout(function () {
                $('.toast').fadeOut();
            }, timer || 1000)
        }
    </script>


    <script src="./v1_files/jweixin-1.0.0.js"></script>
    <script>
        function initWXSahre() {

            //“分享给朋友”
            wx.onMenuShareAppMessage({
                title: '测测你的隐藏旅行属性', // 分享标题
                desc: '你是打卡狂魔，还是逛吃逛吃党？', // 分享描述
                link: '', // 分享链接
                imgUrl: 'http://ma.eldesign.cn/tourTest/img/share_logo.jpg', // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    // 用户确认分享后执行的回调函数
                    _hmt.push(['_trackEvent', '分享', '分享给朋友']);

                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });

            //“分享到朋友圈”
            wx.onMenuShareTimeline({
                title: '测测你的隐藏旅行属性', // 分享标题
                desc: '你是打卡狂魔，还是逛吃逛吃党？', // 分享描述
                link: '', // 分享链接
                imgUrl: 'http://ma.eldesign.cn/tourTest/img/share_logo.jpg', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                    _hmt.push(['_trackEvent', '分享', '分享朋友圈']);
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
        }

        function initWX(callback) {

            $.ajax({
                type: 'GET',
                url: '/api/getWxSDK',
                data: {
                    'originalUrl': window.location.href
                },
                success: function (data) {
                    var wxConfig = data.data.wxConfig;

                    console.log(wxConfig);

                    wx.config({
                        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                        appId: wxConfig.appId, // 必填，公众号的唯一标识
                        timestamp: wxConfig.timestamp, // 必填，生成签名的时间戳
                        nonceStr: wxConfig.nonceStr, // 必填，生成签名的随机串
                        signature: wxConfig.signature, // 必填，签名，见附录1
                        jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
                    });

                    wx.ready(function () {
                        callback && callback();
                    });

                    wx.error(function (res) {
                        console.log(res);
                    });


                },
                dataType: 'json'
            });
        }

        initWX(initWXSahre);
    </script>



</body>

</html>